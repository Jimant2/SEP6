@page "/login"
@inject HttpClient httpClient
@inject NavigationManager navigationManager
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject NavigationManager NavgMan
@inject IUserService _serviceUser;
@using System.Net.Http;
@using SEP6.Authentication;
@using SEP6.Data;

<style>
    .container {
        display: flex;
        align-items: center;
    }

    .image-container {
        margin-right: 20px;
    }
</style>


<h3>Movies4U</h3>

<div class="container">
    <div class="image-container">
        <img src="img/movie_system_logo.jpg" alt="Movies 4 U" />
    </div>

<div class="form-group">
    <label for="name">Name:</label>
    <input id="name" class="form-control" @bind="@name" />
</div>

<div class="form-group">
    <label for="id">ID:</label>
    <input id="id" class="form-control" @bind="@id" />
</div>
</div>

<AuthorizeView>

    <NotAuthorized>
        <button class="btn btn-primary" @onclick="Login">Login</button>

    </NotAuthorized>
</AuthorizeView>



<p>@errorMessage</p>

@code {
    private string name;
    private int id;
    private string errorMessage;

 

    private async Task Login()
    {
       


        //TODO: New page to navigate after login
        try
        {
            await ((CustomAuthenticationStateProvider)AuthenticationStateProvider).ValidateLogin(name, id);
            NavgMan.NavigateTo("/");
        }
        catch (Exception e)
        {
            Console.WriteLine(e.Message);
            errorMessage = e.Message;
        }

    }
}